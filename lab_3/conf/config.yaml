# SPDX-FileCopyrightText: Copyright (c) 2023 - 2025 NVIDIA CORPORATION & AFFILIATES.
# SPDX-License-Identifier: Apache-2.0
#
# Transolver Training Configuration for Stokes Flow
# Lab 3: Physics-Attention and Transolver

# Model Architecture (PhysicsNeMo Transolver)
model:
  # Input/Output dimensions
  functional_dim: 0        # No additional functional input (coordinates only)
  embedding_dim: 2         # 2D coordinates as spatial embeddings
  out_dim: 3               # Output: u, v, p
  
  # Architecture (following PhysicsNeMo defaults)
  n_hidden: 256
  n_layers: 4
  n_head: 8
  dropout: 0.0
  act: gelu
  mlp_ratio: 4
  slice_num: 32            # Number of learned slices (M)
  
  # Mesh type (unstructured for Stokes)
  unified_pos: false       # We provide our own embeddings
  structured_shape: null   # Irregular/unstructured mesh
  ref: 8                   # Reference grid for unified_pos (unused here)
  use_te: false            # Don't require Transformer Engine
  time_input: false        # No time dependence

# Data
data:
  dataset_path: "../lab_2/dataset"

# Scheduler (following PhysicsNeMo pattern)
scheduler:
  initial_lr: 1.0e-3
  decay_rate: 0.5
  decay_epochs: 50         # Decay every N epochs

# Training
training:
  epochs: 200
  num_samples: 100         # Number of training samples to use
  batch_size: 1            # Process one sample at a time (variable mesh sizes)
  weight_decay: 1.0e-4
  gradient_clip: 1.0
  rec_results_freq: 50     # Save checkpoint every N epochs

# Validation
validation:
  validation_epochs: 20    # Validate every N epochs

# Visualization
visualization:
  snapshot_epochs: [10, 50, 100, 150, 200]
  slice_cmap: "tab20"
  field_cmap_velocity: "RdBu_r"
  field_cmap_pressure: "viridis"

# Logging
logging:
  print_every: 10
